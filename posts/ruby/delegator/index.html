<!doctype html><html lang=en><head><title>Ruby'de Delegatorlar :: Blog.</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Delegatorlar bir obje üzerinde kullanılan ve obje tarafında bir karşılığı bulunmayan tüm metodların constructorda tanımlanmış bir başka objeye yönlendirilmesini sağlar. Bu tanım belki biraz karmaşık gelmiş olabilir fakat benimle kal, mevzu oldukça basit.
Öncelikle klasik bir örnekle başlayalım:
class Pizza def slice &amp;#39;Dilimlendim!&amp;#39; end def to_s &amp;#39;Ben bir pizzayım!&amp;#39; end end class PizzaWithPepperoni &amp;lt; Pizza def to_s super.sub(/((?!\s).)+\!/, &amp;#39;pepperonili pizzayım!&amp;#39;) end end class PizzaWithMushroom &amp;lt; Pizza def to_s super.sub(/((?!\s).)+\!/, &amp;#39;mantarlı pizzayım!"><meta name=keywords content="ruby,delegator,simpledelegator,decorator,pattern,oop,object,oriented"><meta name=robots content="noodp"><link rel=canonical href=https://blackness.me/posts/ruby/delegator/><link rel=stylesheet href=https://blackness.me/css/style.min.css><link rel=stylesheet href=https://blackness.me/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://blackness.me/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://blackness.me/img/favicon.png><meta name=twitter:card content="summary"><meta name=twitter:title content="Ruby'de Delegatorlar"><meta name=twitter:description content="Delegatorlar bir obje üzerinde kullanılan ve obje tarafında bir karşılığı bulunmayan tüm
metodların constructorda tanımlanmış bir başka objeye yönlendirilmesini sağlar. Bu tanım
belki biraz karmaşık gelmiş olabilir fakat benimle kal, mevzu oldukça basit."><meta property="og:title" content="Ruby'de Delegatorlar"><meta property="og:description" content="Delegatorlar bir obje üzerinde kullanılan ve obje tarafında bir karşılığı bulunmayan tüm
metodların constructorda tanımlanmış bir başka objeye yönlendirilmesini sağlar. Bu tanım
belki biraz karmaşık gelmiş olabilir fakat benimle kal, mevzu oldukça basit."><meta property="og:type" content="article"><meta property="og:url" content="https://blackness.me/posts/ruby/delegator/"><meta property="article:published_time" content="2019-09-02T10:56:08+03:00"><meta property="article:modified_time" content="2019-09-02T10:56:08+03:00"><meta property="og:site_name" content="Blog."></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>blackness</span>
<span class=logo__cursor></span></a><span class=header__right><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title><a href=https://blackness.me/posts/ruby/delegator/>Ruby&rsquo;de Delegatorlar</a></h1><div class=post-meta><span class=post-date>2019-09-02</span>
<span class=post-author>—  personinblack</span>
<span class=post-read-time>— 2 dakikada okursun</span></div><span class=post-tags>#<a href=https://blackness.me/tags/ruby/>ruby</a>&nbsp;</span><figure class=post-cover><img src=https://blackness.me/markus-spiske-xwvVT1XN2HE-unsplash.jpg alt="Ruby'de Delegatorlar"></figure><div class=post-content><p>Delegatorlar bir obje üzerinde kullanılan ve obje tarafında bir karşılığı bulunmayan tüm
metodların constructorda tanımlanmış bir başka objeye yönlendirilmesini sağlar. Bu tanım
belki biraz karmaşık gelmiş olabilir fakat benimle kal, mevzu oldukça basit.</p><p>Öncelikle klasik bir örnekle başlayalım:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Pizza</span>
  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>slice</span>
    <span style=color:#e6db74>&#39;Dilimlendim!&#39;</span>
  <span style=color:#66d9ef>end</span>

  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>to_s</span>
    <span style=color:#e6db74>&#39;Ben bir pizzayım!&#39;</span>
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PizzaWithPepperoni</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>Pizza</span>
  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>to_s</span>
    <span style=color:#66d9ef>super</span><span style=color:#f92672>.</span>sub(<span style=color:#e6db74>/((?!\s).)+\!/</span>, <span style=color:#e6db74>&#39;pepperonili pizzayım!&#39;</span>)
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PizzaWithMushroom</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>Pizza</span>
  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>to_s</span>
    <span style=color:#66d9ef>super</span><span style=color:#f92672>.</span>sub(<span style=color:#e6db74>/((?!\s).)+\!/</span>, <span style=color:#e6db74>&#39;mantarlı pizzayım!&#39;</span>)
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>

puts <span style=color:#66d9ef>PizzaWithPepperoni</span><span style=color:#f92672>.</span>new<span style=color:#f92672>.</span>to_s <span style=color:#75715e>#=&gt; &#34;Ben bir pepperonili pizzayım!&#34;</span>
puts <span style=color:#66d9ef>PizzaWithMushroom</span><span style=color:#f92672>.</span>new<span style=color:#f92672>.</span>to_s <span style=color:#75715e>#=&gt; &#34;Ben bir mantarlı pizzayım!&#34;</span>

puts <span style=color:#66d9ef>PizzaWithPepperoni</span><span style=color:#f92672>.</span>new<span style=color:#f92672>.</span>slice <span style=color:#75715e>#=&gt; &#34;Dilimlendim!&#34;</span>
</code></pre></div><p>Yukarıdaki örnekteki classlar ile 3 farklı Pizza üretebiliyoruz:
<em>Klasik Pizza</em>, <em>Mantarlı Pizza</em> ve <em>Pepperonili Pizza</em>. Eğer mantarlı ve pepperonili bir
pizza istersek yeni bir obje oluşturmamız gerekecek. Bir de işin içerisine <em>Domatesli
Pizza</em>&lsquo;nın girdiğini düşün! Bu durumda 3 farklı malzeme ve bu malzemelerle yapılabilecek
bir sürü farklı pizza için bir sürü farklı class&mldr;</p><p>Böyle bir durumda decorator pattern kullanmayı deneyebiliriz:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Pizza</span>
  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>slice</span>
    <span style=color:#e6db74>&#39;Dilimlendim!&#39;</span>
  <span style=color:#66d9ef>end</span>

  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>to_s</span>
    <span style=color:#e6db74>&#39;Ben bir pizzayım!&#39;</span>
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Pepperoni</span>
  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>initialize</span>(base)
    @base <span style=color:#f92672>=</span> base
  <span style=color:#66d9ef>end</span>

  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>to_s</span>
    @base<span style=color:#f92672>.</span>to_s<span style=color:#f92672>.</span>sub(<span style=color:#e6db74>/((?!\s).)+\!/</span>, <span style=color:#e6db74>&#39;pepperonili pizzayım!&#39;</span>)
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Mushroom</span>
  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>initialize</span>(base)
    @base <span style=color:#f92672>=</span> base
  <span style=color:#66d9ef>end</span>

  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>to_s</span>
    @base<span style=color:#f92672>.</span>to_s<span style=color:#f92672>.</span>sub(<span style=color:#e6db74>/((?!\s).)+\!/</span>, <span style=color:#e6db74>&#39;mantarlı pizzayım!&#39;</span>)
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>

puts <span style=color:#66d9ef>Mushroom</span><span style=color:#f92672>.</span>new(<span style=color:#66d9ef>Pizza</span><span style=color:#f92672>.</span>new)<span style=color:#f92672>.</span>to_s <span style=color:#75715e>#=&gt; &#34;Ben bir mantarlı pizzayım!&#34;</span>
puts <span style=color:#66d9ef>Pepperoni</span><span style=color:#f92672>.</span>new(<span style=color:#66d9ef>Mushroom</span><span style=color:#f92672>.</span>new(<span style=color:#66d9ef>Pizza</span><span style=color:#f92672>.</span>new))<span style=color:#f92672>.</span>to_s <span style=color:#75715e>#=&gt; &#34;Ben bir mantarlı pepperonili pizzayım!&#34;</span>
</code></pre></div><p>Yukarıdaki örnek çok daha iyi öyle değil mi? Malzemeleri istediğimiz gibi ekleyip
çıkartabiliyoruz mesela. Yeni bir malzeme üretmek için ise tek yapmamız gereken yeni bir
class oluşturmak. Böylelikle elimizde sadece <code>malzeme sayısı + 1</code> adet class oluyor.</p><p>Fakat bu örnekte de bir sıkıntı var. <code>slice</code> metodu sadece <code>Pizza</code> sınıfına ait. Yani
<code>Pepperoni.new(Pizza.new).slice</code> dediğimizde <code>undefined method 'slice'</code> hatasını
alıyoruz. Çünkü Pepperoni&rsquo;de bu metodun bir karşılığı yok.</p><p>Peki bunu nasıl çözeriz? Malzemelerde <code>slice</code> metodunu tanımlayabiliriz; fakat slice gibi
başka metotlar da olabileceği için bu oldukça zahmetli olur ve normalde çok basit olması
gereken malzeme classlarını karmaşıklaştırabilir. Delegatorlar? Evet Delegatorlar.</p><p>Yukarıdaki malzeme classlarını SimpleDelegator kullanacak şekilde düzenleyelim:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Pepperoni</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>SimpleDelegator</span>
  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>to_s</span>
    <span style=color:#66d9ef>super</span><span style=color:#f92672>.</span>to_s<span style=color:#f92672>.</span>sub(<span style=color:#e6db74>/((?!\s).)+\!/</span>, <span style=color:#e6db74>&#39;pepperonili pizzayım!&#39;</span>) <span style=color:#75715e>#=&gt; &#34;Ben bir pepperonili pizzayım!&#34;</span>
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>

pizza <span style=color:#f92672>=</span> <span style=color:#66d9ef>Pepperoni</span><span style=color:#f92672>.</span>new(<span style=color:#66d9ef>Pizza</span><span style=color:#f92672>.</span>new)
puts pizza<span style=color:#f92672>.</span>to_s <span style=color:#75715e>#=&gt; &#34;Ben bir pepperonili pizzayım!&#34;</span>
puts pizza<span style=color:#f92672>.</span>slice <span style=color:#75715e>#=&gt; &#34;Dilimlendim!&#34;</span>
</code></pre></div><p>SimpleDelegator, Pepperoni objesi üzerinde kullanılan <code>slice</code> metodunu, otomatik olarak
constructorda tanımlanan Pizza objesine yönlendirerek, metodun çalışmasını sağladı.
Üstelik daha önce elle tanımlamak zorunda kaldığımız constructor metodunu da kendisi
tanımladığından, classımızı daha minimal bir hale getirebildik.</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Başka</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://blackness.me/posts/android/youtube-dl/><span class=button__icon>←</span>
<span class=button__text>Android ve youtube-dl</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>blackness</span>
<span class=logo__cursor></span></a><div class=copyright><span>© 2020 Powered by <a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by <a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span></div></div></footer><script src=https://blackness.me/js/menu.js></script><script src=https://blackness.me/js/theme.js></script><script src=https://blackness.me/js/prism.js></script></div></body></html>